<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Retail Management
  </title>
  <link href="https://i.imgur.com/h08m3tz.png" rel="icon" type="image/png"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&amp;display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <style>
   body {
      font-family: 'Inter', sans-serif;
      background-color: #f9fafb;
      color: #1f2937;
      margin: 0;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-size: 14px;
      line-height: 1.5;
      user-select: none;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    #app {
      max-width: 720px;
      margin: 2rem auto 3rem;
      padding: 0 1rem;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      user-select: none;
      transition: color 0.3s ease;
    }
    header {
      background-color: #ffffff;
      border-radius: 0.75rem;
      padding: 0.75rem 1.25rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: nowrap;
      user-select: none;
      border: 1px solid #d1d5db;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
      transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    }
    #headerIconWrapper {
      width: 44px;
      height: 44px;
      border-radius: 0.5rem;
      border: 2px solid #1f2937;
      background: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      flex-shrink: 0;
      transition: border-color 0.3s ease;
      cursor: default;
    }
    #headerIconWrapper:hover {
      border-color: #4b5563;
    }
    #headerIcon {
      width: 38px;
      height: 38px;
      border-radius: 0.4rem;
      object-fit: cover;
      background: transparent;
      position: relative;
      z-index: 1;
      user-select: none;
      pointer-events: none;
    }
    #retailTitle {
      font-weight: 700;
      font-size: 1.3rem;
      line-height: 1.1;
      color: #1f2937;
      white-space: nowrap;
      flex-grow: 1;
      min-width: 0;
      user-select: text;
      text-shadow: none;
      transition: color 0.3s ease, text-shadow 0.3s ease;
    }
    #semesterContainer {
      font-weight: 500;
      color: #6b7280;
      font-size: 0.85rem;
      white-space: nowrap;
      user-select: text;
      margin-left: 0.3rem;
      flex-shrink: 0;
      font-style: normal;
      letter-spacing: 0.02em;
      transition: color 0.3s ease;
    }
    #semesterContainer strong {
      font-weight: 700;
    }
    #controlButtons {
      display: flex;
      gap: 0.75rem;
      flex-shrink: 0;
      align-items: center;
    }
    .control-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      cursor: pointer;
      color: #1f2937;
      background-color: transparent;
      border: 1.5px solid #1f2937;
      border-radius: 0.5rem;
      padding: 0;
      position: relative;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
      font-size: 1.2rem;
      line-height: 1;
      user-select: none;
    }
    .control-btn:hover,
    .control-btn:focus-visible {
      background-color: #1f2937;
      color: #f9fafb;
      border-color: #374151;
      outline: none;
      box-shadow: 0 0 8px #374151cc;
    }
    #currentDateContainer {
      margin-top: 1.5rem;
      background-color: #f3f4f6;
      color: #4b5563;
      padding: 0.4rem 0.75rem;
      border-radius: 9999px;
      font-weight: 600;
      font-size: 0.85rem;
      user-select: none;
      max-width: 720px;
      margin-left: auto;
      margin-right: auto;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      white-space: nowrap;
      justify-content: center;
      border: 1px solid #d1d5db;
      box-shadow: 0 1px 6px rgb(0 0 0 / 0.1);
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    }
    #currentDateContainer i {
      font-size: 1.3rem;
      flex-shrink: 0;
      color: #6b7280;
      transition: color 0.3s ease;
    }
    #currentDateContainer .divider {
      width: 1.5px;
      height: 1.2rem;
      background-color: #9ca3af;
      border-radius: 1px;
      opacity: 0.5;
      transition: background-color 0.3s ease;
    }
    #currentDateContainer .date-part,
    #currentDateContainer .time-part {
      user-select: none;
    }
    /* Next exam notification */
    #nextExamNotification > div {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 700;
      font-size: 0.95rem;
      border-radius: 0.75rem;
      padding: 0.6rem 1rem;
      cursor: pointer;
      user-select: none;
      overflow: hidden;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
      border: 2px solid transparent;
      max-width: 720px;
      margin: 2rem auto 2.5rem auto;
      flex-wrap: nowrap;
      background-color: #f9fafb;
      color: #1f2937;
      justify-content: space-between;
      border-color: #d1d5db;
      box-shadow: 0 0 12px rgb(0 0 0 / 0.05);
      user-select: none;
    }
    #nextExamNotification > div:hover,
    #nextExamNotification > div:focus-visible {
      background-color: #374151;
      color: #f9fafb;
      border-color: #4b5563;
      outline: none;
      box-shadow: 0 0 16px #4b5563cc;
    }
    #nextExamNotification > div.default {
      background-color: transparent;
      color: #9ca3af;
      border-color: #d1d5db;
      cursor: default;
      box-shadow: none;
    }
    #nextExamNotification > div.hour1,
    #nextExamNotification > div.hour2,
    #nextExamNotification > div.hour3,
    #nextExamNotification > div.hour4plus {
      background-color: #f9fafb;
      color: #1f2937;
      border-color: #d1d5db;
      box-shadow: 0 0 12px rgb(0 0 0 / 0.05);
    }
    #nextExamNotification > div.alert {
      background-color: #374151;
      color: #f9fafb;
      border-color: #4b5563;
      font-weight: 800;
      animation: pulse 2s infinite ease-in-out;
      box-shadow: 0 0 20px #4b5563dd;
    }
    #nextExamNotification i {
      flex-shrink: 0;
      font-size: 1.3rem;
      min-width: 1.5rem;
      text-align: center;
      color: inherit;
      user-select: none;
      transition: color 0.3s ease;
    }
    #nextExamNotification strong {
      flex-shrink: 1;
      font-weight: 800;
      font-size: 1rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 55%;
      line-height: 1.2;
      color: inherit;
      user-select: text;
      margin-right: 0.75rem;
      transition: color 0.3s ease;
    }
    #nextExamNotification span.date {
      flex-shrink: 0;
      white-space: nowrap;
      min-width: 6.5rem;
      font-weight: 600;
      font-size: 0.85rem;
      text-align: right;
      color: inherit;
      user-select: none;
      margin-right: 0.75rem;
      font-variant-numeric: tabular-nums;
      transition: color 0.3s ease;
    }
    #nextExamNotification span.timeleft {
      flex-shrink: 0;
      white-space: nowrap;
      font-weight: 700;
      min-width: 8.5rem;
      text-align: right;
      font-variant-numeric: tabular-nums;
      color: inherit;
      user-select: none;
      transition: color 0.3s ease;
    }
    @media (max-width: 720px) {
      #nextExamNotification > div {
        font-size: 0.8rem;
        gap: 0.3rem;
        padding: 0.45rem 0.75rem;
        border-radius: 0.6rem;
        justify-content: space-between;
        align-items: center;
      }
      #nextExamNotification strong {
        max-width: 45%;
        font-size: 0.9rem;
        margin-right: 0.4rem;
      }
      #nextExamNotification span.date,
      #nextExamNotification span.timeleft {
        min-width: auto;
        text-align: right;
        flex: 0 0 auto;
        font-size: 0.75rem;
        font-weight: 600;
        margin-right: 0.4rem;
      }
      #nextExamNotification i {
        font-size: 1.1rem;
        min-width: 1.3rem;
      }
    }
    /* Date filters container */
    #dateFilters {
      justify-content: center;
      margin-bottom: 1.5rem;
      gap: 0.4rem;
      flex-wrap: wrap;
      display: flex;
      width: 100%;
    }
    /* Date chips */
    .date-chip {
      padding: 0.35rem 1rem;
      border-radius: 9999px;
      font-size: 0.85rem;
      font-weight: 700;
      border: 2px solid #6b7280cc;
      background-color: transparent;
      color: #6b7280cc;
      transition: all 0.3s ease;
      cursor: pointer;
      user-select: none;
      min-width: 90px;
      text-align: center;
      white-space: nowrap;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0;
      flex-shrink: 0;
      box-shadow: 0 0 6px rgb(107 114 128 / 0.1);
    }
    .date-chip:hover:not(:disabled) {
      background-color: #374151;
      color: #f9fafb;
      box-shadow: 0 0 12px #4b5563cc;
      transform: scale(1.1);
    }
    .date-chip[aria-pressed="true"] {
      background-color: #374151;
      color: #f9fafb;
      cursor: default;
      transform: scale(1.1);
      box-shadow: 0 0 14px #4b5563dd;
    }
    .date-chip:disabled {
      cursor: not-allowed;
      opacity: 0.3;
      background-color: transparent !important;
      color: #9ca3af !important;
      border-color: #9ca3af !important;
      box-shadow: none;
      transform: none;
    }
    /* Masked style for completed dates */
    .date-chip.masked {
      cursor: default;
      background-color: transparent !important;
      color: #9ca3af !important;
      border-color: #9ca3af !important;
      box-shadow: none !important;
      opacity: 0.3;
      pointer-events: none;
      user-select: none;
    }
    /* Exam cards grid */
    #examList {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1rem;
      width: 100%;
    }
    /* Exam card */
    .exam-card {
      background-color: #ffffff;
      border-radius: 1rem;
      overflow: hidden;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      flex-direction: row;
      border: 2px solid transparent;
      user-select: none;
      min-height: 72px;
      align-items: center;
      padding: 0.6rem 1rem;
      gap: 1rem;
      color: #1f2937;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
    }
    .exam-card:hover,
    .exam-card:focus-visible {
      background-color: #374151;
      color: #f9fafb;
      border-color: #4b5563;
      outline: none;
      box-shadow: 0 0 16px #4b5563cc;
    }
    .exam-card.opacity-50 {
      opacity: 0.3;
      cursor: default;
      pointer-events: none;
      border-color: #d1d5db;
      background-color: #e5e7eb;
      color: #9ca3af;
      transform: none !important;
      box-shadow: none;
    }
    .exam-card .icon-wrapper {
      flex-shrink: 0;
      width: 40px;
      height: 40px;
      border-radius: 0.75rem;
      background-color: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #4b5563cc;
      font-size: 1.4rem;
      transition: color 0.3s ease;
      user-select: none;
      box-shadow: 0 0 6px rgb(75 85 99 / 0.1);
    }
    .exam-card:hover .icon-wrapper,
    .exam-card:focus-visible .icon-wrapper {
      color: #f9fafb;
      filter: drop-shadow(0 0 2px #f9fafb);
    }
    .exam-card .info {
      flex-grow: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 0.15rem;
      overflow: hidden;
    }
    .exam-card h3 {
      font-size: 1rem;
      font-weight: 800;
      color: inherit;
      margin: 0;
      line-height: 1.2;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      user-select: text;
      text-shadow: none;
      transition: color 0.3s ease;
    }
    .exam-card .sub-info {
      display: flex;
      gap: 1rem;
      font-size: 0.8rem;
      color: #6b7280;
      font-weight: 600;
      user-select: none;
      flex-wrap: nowrap;
      transition: color 0.3s ease;
    }
    .exam-card .sub-info span {
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }
    .exam-card .sub-info span i {
      font-size: 0.85rem;
      color: #9ca3af;
      flex-shrink: 0;
      transition: color 0.3s ease;
    }
    .exam-card .chevron {
      flex-shrink: 0;
      color: #6b7280;
      font-size: 1.2rem;
      transition: color 0.3s ease;
      user-select: none;
    }
    .exam-card:hover .chevron,
    .exam-card:focus-visible .chevron {
      color: #f9fafb;
    }
    /* No results */
    #noResults {
      max-width: 600px;
      margin: 4rem auto;
      color: #9ca3af;
      font-size: 1.1rem;
      user-select: none;
      text-align: center;
      transition: color 0.3s ease;
    }
    #noResults i {
      font-size: 3.5rem;
      margin-bottom: 1.25rem;
      color: #6b7280;
      transition: color 0.3s ease;
    }
    /* Animations */
    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.6;
      }
    }
  </style>
 </head>
 <body>
  <div aria-label="Retail Management Application" id="app" role="main">
   <header>
    <div aria-label="Retail Management logo with dark border" id="headerIconWrapper" role="img" tabindex="0">
     <img alt="Animated gif icon showing a colorful swirling pattern with bright neon colors in motion" draggable="false" height="38" id="headerIcon" src="https://i.giphy.com/4cJAkBS9KAOz2px44s.webp" width="38"/>
    </div>
    <div style="flex-grow:1; min-width:0; overflow: hidden;">
     <h1 class="select-text" id="retailTitle" title="Retail Management">
      Retail Management
     </h1>
     <div id="semesterContainer" title="Current semester and greeting">
      <strong>(जय श्री राम)</strong>
     </div>
    </div>
    <div id="controlButtons" role="group" aria-label="Audio and theme controls">
     <button aria-label="Toggle dark and light mode" class="control-btn" id="themeToggleBtn" tabindex="0" title="Toggle dark and light mode" type="button">
      <i aria-hidden="true" class="fas fa-moon"></i>
     </button>
     <button aria-label="Mute audio" aria-pressed="false" class="control-btn" id="audioControlBtn" tabindex="0" title="Mute audio" type="button">
      <i aria-hidden="true" class="fas fa-volume-up"></i>
     </button>
    </div>
   </header>
   <div aria-atomic="true" aria-live="polite" id="currentDateContainer" tabindex="0" title="Current date and time">
    <i aria-hidden="true" class="fas fa-calendar-day"></i>
    <span aria-label="Current date" class="date-part">
     Sun, 27 Apr, 2025
    </span>
    <span aria-hidden="true" class="divider"></span>
    <span aria-label="Current time" class="time-part">
     10:56:58 pm
    </span>
   </div>
   <section aria-atomic="true" aria-live="polite" id="nextExamNotification">
    <div aria-label="Next exam is International Retailing and Bench Mark Retailers (IR &amp; BR) on Mon, 28 Apr, click to open details" class="cursor-pointer hour4plus" role="link" tabindex="0">
     <i aria-hidden="true" class="fas fa-bell"></i>
     <strong class="truncate" data-full="International Retailing and Bench Mark Retailers (IR &amp; BR)" title="International Retailing and Bench Mark Retailers (IR &amp; BR)">
      International Retailing and Bench Mark Retailers (IR &amp; BR)
     </strong>
     <span aria-label="Exam date" class="date">
      Mon, 28 Apr
     </span>
     <span aria-label="Time left" class="timeleft">
      Starts in: 15:03:01
     </span>
    </div>
   </section>
   <main>
    <div aria-label="Filter exams by date" class="flex" id="dateFilters" role="list"></div>
    <div aria-atomic="true" aria-label="List of exams" aria-live="polite" id="examList" role="list"></div>
    <div aria-live="assertive" class="hidden" id="noResults" role="alert" tabindex="0">
     <i aria-hidden="true" class="fas fa-search"></i>
     <p>
      No exams found matching your search.
     </p>
    </div>
   </main>
  </div>
  <script>
   (() => {
      const examSchedule = [
        {
          date: "22-04-2025",
          day: "Tuesday",
          paper: "Supply Chain Management (SCM)",
          code: "ARM-S-447-B",
          path: "https://telegra.ph/androidneeds-03-02",
          icon: "truck-loading",
          short: "SCM",
        },
        {
          date: "23-04-2025",
          day: "Wednesday",
          paper: "Visual Merchandising (VM)",
          code: "ARM-S-448-B",
          path: "https://telegra.ph/How-to-Make-Your-Own-Hand-Sanitizer-04-25",
          icon: "palette",
          short: "VM",
        },
        {
          date: "24-04-2025",
          day: "Thursday",
          paper: "E-Retailing (ER)",
          code: "ARM-S-449-B",
          path: "https://telegra.ph/Fraudsters-Try-To-Scam-PM-CARES-Donors-With-Fake-UPI-ID-03-31",
          icon: "shopping-cart",
          short: "ER",
        },
        {
          date: "25-04-2025",
          day: "Friday",
          paper: "Marketing Research (MR)",
          code: "ARM-S-450-B",
          path: "https://telegra.ph/Top-sites-for-career-04-11",
          icon: "chart-line",
          short: "MR",
        },
        {
          date: "28-04-2025",
          day: "Monday",
          paper: "International Retailing and Bench Mark Retailers (IR & BR)",
          code: "ARM-S-451-B",
          path: "IR&BR.html",
          icon: "globe-americas",
          short: "IR & BR",
        },
        {
          date: "29-04-2025",
          day: "Tuesday",
          paper: "Multi Brand Retailing (MBR)",
          code: "ARM-S-452-B",
          path: "https://telegra.ph/Projects-to-do-04-12",
          icon: "store",
          short: "MBR",
        },
        {
          date: "30-04-2025",
          day: "Wednesday",
          paper: "Retail Communications (RC)",
          code: "ARM-S-453-B",
          path: "https://telegra.ph/Big-news-03-30",
          icon: "comments",
          short: "RC",
        },
      ];

      let selectedDate = null;

      const dateFilters = document.getElementById("dateFilters");
      const examList = document.getElementById("examList");
      const noResults = document.getElementById("noResults");
      const currentDateContainer = document.getElementById("currentDateContainer");
      const currentDatePart = currentDateContainer.querySelector(".date-part");
      const currentTimePart = currentDateContainer.querySelector(".time-part");
      const nextExamNotification = document.getElementById("nextExamNotification");
      const nextExamDiv = nextExamNotification.querySelector("div");
      const nextExamStrong = nextExamDiv.querySelector("strong");
      const nextExamDateSpan = nextExamDiv.querySelector("span.date");
      const nextExamTimeLeftSpan = nextExamDiv.querySelector("span.timeleft");

      // Audio setup
      const audio = new Audio(
        "https://od.lk/s/NDJfNDc5OTY4ODZf/End%20Credit.m4a"
      );
      audio.volume = 0.3;
      audio.preload = "auto";
      audio.autoplay = true;
      audio.loop = false;
      audio.muted = false;

      window.addEventListener("load", () => {
        audio.play().catch(() => {
          function userInteract() {
            audio.muted = false;
            audio.play().catch(() => {});
            window.removeEventListener("click", userInteract);
            window.removeEventListener("keydown", userInteract);
            window.removeEventListener("touchstart", userInteract);
          }
          window.addEventListener("click", userInteract);
          window.addEventListener("keydown", userInteract);
          window.addEventListener("touchstart", userInteract);
        });
      });

      const audioControlBtn = document.getElementById("audioControlBtn");
      const themeToggleBtn = document.getElementById("themeToggleBtn");
      const body = document.body;

      function updateAudioButton() {
        if (audio.muted || audio.volume === 0) {
          audioControlBtn.setAttribute("aria-label", "Unmute audio");
          audioControlBtn.setAttribute("title", "Unmute audio");
          audioControlBtn.setAttribute("aria-pressed", "true");
          audioControlBtn.innerHTML = `<i class="fas fa-volume-mute" aria-hidden="true"></i>`;
        } else {
          audioControlBtn.setAttribute("aria-label", "Mute audio");
          audioControlBtn.setAttribute("title", "Mute audio");
          audioControlBtn.setAttribute("aria-pressed", "false");
          audioControlBtn.innerHTML = `<i class="fas fa-volume-up" aria-hidden="true"></i>`;
        }
      }

      audioControlBtn.addEventListener("click", () => {
        if (audio.muted || audio.volume === 0) {
          audio.muted = false;
          if (audio.paused) {
            audio.play().catch(() => {});
          }
        } else {
          audio.muted = true;
        }
        updateAudioButton();
      });

      audioControlBtn.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          audioControlBtn.click();
        }
      });

      updateAudioButton();

      // Theme toggle logic
      function updateThemeButtonIcon() {
        if (body.classList.contains("light")) {
          themeToggleBtn.setAttribute("aria-label", "Switch to dark mode");
          themeToggleBtn.setAttribute("title", "Switch to dark mode");
          themeToggleBtn.innerHTML = `<i class="fas fa-moon" aria-hidden="true"></i>`;
        } else {
          themeToggleBtn.setAttribute("aria-label", "Switch to light mode");
          themeToggleBtn.setAttribute("title", "Switch to light mode");
          themeToggleBtn.innerHTML = `<i class="fas fa-sun" aria-hidden="true"></i>`;
        }
      }

      themeToggleBtn.addEventListener("click", () => {
        body.classList.toggle("light");
        updateThemeButtonIcon();
      });

      themeToggleBtn.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          themeToggleBtn.click();
        }
      });

      // Set light mode by default
      body.classList.add("light");
      updateThemeButtonIcon();

      function getExamEndDateTime(exam) {
        const [dd, mm, yyyy] = exam.date.split("-");
        return new Date(`${yyyy}-${mm}-${dd}T17:00:00`);
      }

      function filterExams() {
        return examSchedule.filter((exam) => {
          if (selectedDate && exam.date !== selectedDate) return false;
          const now = new Date();
          const examEnd = getExamEndDateTime(exam);
          return examEnd >= now;
        });
      }

      function renderDateFilters() {
        const uniqueDates = [...new Set(examSchedule.map((exam) => exam.date))];
        const now = new Date();

        dateFilters.innerHTML = "";
        uniqueDates.forEach((date) => {
          const examsOnDate = examSchedule.filter((e) => e.date === date);
          const allPassed = examsOnDate.every((exam) => getExamEndDateTime(exam) < now);

          if (allPassed) return; // Hide completed dates

          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "date-chip";
          btn.setAttribute("aria-pressed", selectedDate === date);
          btn.title = `Filter exams on ${date}`;
          btn.textContent = date;
          btn.addEventListener("click", () => {
            selectedDate = selectedDate === date ? null : date;
            render();
          });
          dateFilters.appendChild(btn);
        });
      }

      function renderExams() {
        const filteredExams = filterExams();
        examList.innerHTML = "";

        if (filteredExams.length === 0) {
          noResults.classList.remove("hidden");
          return;
        } else {
          noResults.classList.add("hidden");
        }

        filteredExams.forEach((exam, index) => {
          const examEnd = getExamEndDateTime(exam);
          const now = new Date();
          const isPast = examEnd < now;

          if (isPast) return;

          const card = document.createElement("article");
          card.className = `exam-card`;
          card.style.animationDelay = `${index * 0.1}s`;
          card.setAttribute("tabindex", "0");
          card.setAttribute("role", "link");
          card.setAttribute("aria-label", `Open details for exam ${exam.paper} on ${exam.date}`);

          card.addEventListener("click", () => {
            window.open(exam.path, "_blank", "noopener,noreferrer");
          });
          card.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              card.click();
            }
          });

          const iconDiv = document.createElement("div");
          iconDiv.className = "icon-wrapper";
          const icon = document.createElement("i");
          icon.className = `fas fa-${exam.icon}`;
          icon.setAttribute("aria-hidden", "true");
          iconDiv.appendChild(icon);

          const infoDiv = document.createElement("div");
          infoDiv.className = "info";

          const title = document.createElement("h3");
          title.textContent = exam.paper;

          const subInfo = document.createElement("div");
          subInfo.className = "sub-info";

          const daySpan = document.createElement("span");
          daySpan.innerHTML = `<i class="fas fa-calendar-day" aria-hidden="true"></i> ${exam.day}`;

          const codeSpan = document.createElement("span");
          codeSpan.innerHTML = `<i class="fas fa-barcode" aria-hidden="true"></i> ${exam.code}`;

          subInfo.appendChild(daySpan);
          subInfo.appendChild(codeSpan);

          infoDiv.appendChild(title);
          infoDiv.appendChild(subInfo);

          const chevron = document.createElement("i");
          chevron.className = "fas fa-chevron-right chevron";
          chevron.setAttribute("aria-hidden", "true");

          card.appendChild(iconDiv);
          card.appendChild(infoDiv);
          card.appendChild(chevron);

          examList.appendChild(card);
        });
      }

      function updateCurrentDate() {
        const now = new Date();
        const optionsDate = { weekday: "short", year: "numeric", month: "short", day: "numeric" };
        const optionsTime = { hour: "numeric", minute: "2-digit", second: "2-digit", hour12: true };
        const dateStr = now.toLocaleDateString(undefined, optionsDate);
        const timeStr = now.toLocaleTimeString(undefined, optionsTime);
        currentDatePart.textContent = dateStr;
        currentTimePart.textContent = timeStr;
      }

      function getNextExam() {
        const now = new Date();
        const upcomingExams = examSchedule
          .map((exam) => {
            const [dd, mm, yyyy] = exam.date.split("-");
            const examStart = new Date(`${yyyy}-${mm}-${dd}T14:00:00`);
            const examEnd = new Date(`${yyyy}-${mm}-${dd}T17:00:00`);
            return { ...exam, examStart, examEnd };
          })
          .filter((exam) => exam.examEnd >= now)
          .sort((a, b) => a.examStart - b.examStart);

        return upcomingExams.length > 0 ? upcomingExams[0] : null;
      }

      function formatTimeLeft(ms) {
        if (ms <= 0) return "0s";
        const totalSeconds = Math.floor(ms / 1000);
        const days = Math.floor(totalSeconds / 86400);
        const hours = Math.floor((totalSeconds % 86400) / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;
        let result = "";
        if (days > 0) result += days + (days === 1 ? " day " : " days ");
        result +=
          (hours < 10 ? "0" : "") +
          hours +
          ":" +
          (minutes < 10 ? "0" : "") +
          minutes +
          ":" +
          (seconds < 10 ? "0" : "") +
          seconds;
        return result;
      }

      let nextExamInterval = null;

      function updateNextExamNotification() {
        const nextExam = getNextExam();
        if (!nextExam) {
          nextExamStrong.textContent = "No upcoming exams";
          nextExamDateSpan.textContent = "";
          nextExamTimeLeftSpan.textContent = "";
          nextExamDiv.className = "default";
          nextExamDiv.classList.remove("alert");
          nextExamDiv.classList.remove("hour1", "hour2", "hour3", "hour4plus");
          nextExamDiv.classList.remove("cursor-pointer");
          nextExamDiv.removeAttribute("role");
          nextExamDiv.removeAttribute("tabindex");
          nextExamDiv.onclick = null;
          nextExamDiv.onkeypress = null;
          if (nextExamInterval) {
            clearInterval(nextExamInterval);
            nextExamInterval = null;
          }
          return;
        }

        function updateTimeLeft() {
          const now = new Date();
          let timeLeftMs;
          let label;
          if (now < nextExam.examStart) {
            timeLeftMs = nextExam.examStart - now;
            label = "Starts in";
          } else if (now >= nextExam.examStart && now <= nextExam.examEnd) {
            timeLeftMs = nextExam.examEnd - now;
            label = "Ends in";
          } else {
            clearInterval(nextExamInterval);
            nextExamInterval = null;
            render();
            return;
          }
          const timeLeftStr = formatTimeLeft(timeLeftMs);
          const options = { weekday: "short", month: "short", day: "numeric" };
          const examDateStr = nextExam.examStart.toLocaleDateString(undefined, options);
          if (window.innerWidth <= 720) {
            nextExamStrong.textContent = nextExam.short || nextExam.paper;
          } else {
            nextExamStrong.textContent = nextExam.paper;
          }
          nextExamDateSpan.textContent = examDateStr;
          nextExamTimeLeftSpan.textContent = `${label}: ${timeLeftStr}`;

          const msToStart = nextExam.examStart - now;
          const hoursToStart = msToStart / (1000 * 60 * 60);

          nextExamDiv.classList.remove("hour1", "hour2", "hour3", "hour4plus", "alert", "default");

          if (label === "Starts in" && msToStart <= 30 * 60 * 1000 && msToStart > 0) {
            nextExamDiv.classList.add("alert");
          } else if (label === "Starts in" && msToStart > 0) {
            if (hoursToStart <= 1) {
              nextExamDiv.classList.add("hour1");
            } else if (hoursToStart <= 2) {
              nextExamDiv.classList.add("hour2");
            } else if (hoursToStart <= 3) {
              nextExamDiv.classList.add("hour3");
            } else {
              nextExamDiv.classList.add("hour4plus");
            }
          } else {
            nextExamDiv.classList.add("default");
          }
        }

        nextExamDiv.classList.add("cursor-pointer");
        nextExamDiv.setAttribute("role", "link");
        nextExamDiv.setAttribute("tabindex", "0");
        nextExamDiv.setAttribute(
          "aria-label",
          `Next exam is ${nextExam.paper} on ${nextExam.examStart.toLocaleDateString(undefined, {
            weekday: "short",
            month: "short",
            day: "numeric",
          })}, click to open details`
        );
        nextExamDiv.onclick = () => {
          window.open(nextExam.path, "_blank", "noopener,noreferrer");
        };
        nextExamDiv.onkeypress = (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            nextExamDiv.click();
          }
        };

        updateTimeLeft();
        if (nextExamInterval) clearInterval(nextExamInterval);
        nextExamInterval = setInterval(updateTimeLeft, 1000);
      }

      function scheduleNextUpdate() {
        const now = new Date();
        const next5pm = new Date(now);
        next5pm.setHours(17, 0, 0, 0);
        if (now >= next5pm) {
          next5pm.setDate(next5pm.getDate() + 1);
        }
        const msUntilNext5pm = next5pm - now;
        setTimeout(() => {
          updateNextExamNotification();
          render();
          scheduleNextUpdate();
        }, msUntilNext5pm);
      }

      function render() {
        renderDateFilters();
        renderExams();
        updateNextExamNotification();
      }

      updateCurrentDate();
      setInterval(updateCurrentDate, 1000);
      render();
      scheduleNextUpdate();

      window.addEventListener("resize", () => {
        const nextExam = getNextExam();
        if (!nextExam) return;
        if (window.innerWidth <= 720) {
          nextExamStrong.textContent = nextExam.short || nextExam.paper;
        } else {
          nextExamStrong.textContent = nextExam.paper;
        }
      });
    })();
  </script>
 </body>
</html>
